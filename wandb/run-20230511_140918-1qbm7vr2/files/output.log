/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/gym/envs/registration.py:555: UserWarning: [33mWARN: The environment Hopper-v2 is out of date. You should consider upgrading to version `v4`.
  logger.warn(
/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/gym/envs/mujoco/mujoco_env.py:190: UserWarning: [33mWARN: This version of the mujoco environments depends on the mujoco-py bindings, which are no longer maintained and may stop working. Please upgrade to the v4 versions of the environments (which depend on the mujoco python bindings instead), unless you are trying to precisely replicate previous works).
  logger.warn(
/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/gym/utils/passive_env_checker.py:233: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  if not isinstance(terminated, (bool, np.bool8)):
  0%|                                                                                                                                                                                                               | 0/300 [00:00<?, ?it/s]
Steps taken: 100
Steps taken: 200
  0%|                                                                                                                                                                                                               | 0/300 [00:00<?, ?it/s]/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/torchsde/_core/adjoint.py:253: UserWarning: The spacing between time points `ts` is not an integer multiple of the time step `dt`. This means that the backward pass (which is forced to step to each of `ts` to get dL/dy(t) for t in ts) will not perfectly mimick the forward pass (which does not step to each `ts`, and instead interpolates to them). This means that method='reversible_heun' may not be perfectly accurate.
  warnings.warn(f"The spacing between time points `ts` is not an integer multiple of the time step `dt`. "
training model ended...
predicting samples, input_size: torch.Size([512, 128, 11])
/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/torchsde/_brownian/brownian_interval.py:594: UserWarning: Should have tb<=t1 but got tb=0.10000000149011612 and t1=0.1.
  warnings.warn(f"Should have {tb_name}<=t1 but got {tb_name}={tb} and t1={self._end}.")
Steps taken: 300
Steps taken: 400
Steps taken: 500
training model, train_size : (4400, 11)
  0%|                                                                                                                                                                                                               | 0/300 [39:07<?, ?it/s]
Traceback (most recent call last):
  File "main_mbpo.py", line 323, in <module>
  File "main_mbpo.py", line 316, in main
    new_pool_size = args.model_retain_epochs * model_steps_per_epoch
  File "main_mbpo.py", line 127, in train
    break
  File "main_mbpo.py", line 190, in train_predict_model
    inputs = state
  File "/home/vishwabrij/COMP5XX/lsde_mbrl/lsde_model.py", line 343, in train
    log_pxs, logqp_path = self.ensemble_model(train_input[i], train_action_input[i], train_reward[i])
  File "/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/vishwabrij/COMP5XX/lsde_mbrl/lsde_model.py", line 204, in forward
    z_pred, log_ratio = torchsde.sdeint_adjoint(
  File "/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/torchsde/_core/adjoint.py", line 233, in sdeint_adjoint
    sde, y0, ts, bm, method, options = sdeint.check_contract(sde, y0, ts, bm, method, adaptive, options, names, logqp)
  File "/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/torchsde/_core/sdeint.py", line 207, in check_contract
    g_diffusion_shape = tuple(sde.g(ts[0], y0).size())
  File "/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/torchsde/_core/base_sde.py", line 275, in g_diagonal
    g = self._base_g(t, y)
  File "/home/vishwabrij/COMP5XX/lsde_mbrl/lsde_model.py", line 166, in g
    out = [g_net_i(y_i) for (g_net_i, y_i) in zip(self.g_nets, y)]
  File "/home/vishwabrij/COMP5XX/lsde_mbrl/lsde_model.py", line 166, in <listcomp>
    out = [g_net_i(y_i) for (g_net_i, y_i) in zip(self.g_nets, y)]
  File "/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 103, in forward
    return F.relu(input, inplace=self.inplace)
  File "/local/scratch/vishwabrij/miniconda3/envs/mbpo/lib/python3.8/site-packages/torch/nn/functional.py", line 1457, in relu
    result = torch.relu(input)
KeyboardInterrupt